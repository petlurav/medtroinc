import time

import pytest

from infra.report.report_manager import ReportManager
from infra.utils.user_creator import UserCreator
from tests.report_service.reporting_cc_sut import ReportingSut


@pytest.fixture(scope="package")
def sut():
    """
       Initialize the DSS SUT
       :return:
       """
    sut = ReportingSut()
    sut.init()
    yield sut
    sut.close()


@pytest.fixture(scope="function")
def user(sut):
    user = UserCreator(f"test_dss_{int(time.time())}")
    user.create()
    ReportManager().info(f"username {user.username} created")
    yield user
    user.close()


@pytest.fixture(scope="function")
def user_de_id(sut):
    user = UserCreator(f"test_auth_deid_{int(time.time())}")
    user.create(de_id_client_id=True)
    ReportManager().info(f"username {user.username} created")
    yield user
    user.close(de_id_client_id=True)
